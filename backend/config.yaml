# 服务器配置
server:
  host: "0.0.0.0"  # 监听地址
  port: 8080  # 监听端口
  debug: false  # 调试模式
  reload: false  # 自动重载
  workers: 1  # 工作进程数

# 数据库
database: ./data/app.db

# AI模型配置 - 支持多模型
ai_models:
  # 默认使用的模型索引（从0开始）
  default_index: 0
  
  # 模型列表
  models:
    - label: "GPT-4o Mini (快速)"  # 前端显示名称
      provider: "openai"
      config:
        api_key: "${OPENAI_API_KEY}"  # 从环境变量获取
        base_url: "https://api.openai.com/v1"
        model: "gpt-4o-mini"
        temperature: 0.3
        max_tokens: 8000
        context_window: 128000  # 模型的上下文窗口大小
        reserved_tokens: 2000    # 预留给系统提示词的tokens
        timeout: 12000
        max_retries: 3
      description: "适合快速处理，成本较低"
      
    - label: "GPT-3.5 Turbo (备用)"  # 前端显示名称
      provider: "openai"
      config:
        api_key: ${OPENAI_API_KEY}
        base_url: "https://api.openai.com/v1"
        model: "gpt-3.5-turbo"
        temperature: 0.5
        max_tokens: 4096
        context_window: 16000   # 模型的上下文窗口大小
        reserved_tokens: 1500    # 预留给系统提示词的tokens
        timeout: 30
        max_retries: 2
      description: "备用模型，成本和性能平衡"

# 文件设置  
file_settings:
  max_file_size: 10485760  # 10MB
  chunk_size: 8000  # 文本分块大小（废弃，改为从模型配置动态计算）
  allowed_extensions:
    - pdf
    - docx
    - md
    - txt

# 目录配置
directories:
  upload_dir: ./data/uploads
  report_dir: ./data/reports
  log_dir: ./data/logs
  temp_dir: ./data/temp

# 日志配置
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "./data/logs/app.log"
  max_size: 10485760  # 10MB
  backup_count: 5

# 任务处理配置
task_processing:
  max_concurrent_tasks: 3  # 最大并发任务数
  task_timeout: 12000  # 任务超时时间（秒）
  retry_failed_tasks: true  # 是否重试失败的任务
  
# CORS配置
cors:
  enabled: true
  origins:
    - "http://localhost:3000"
    - "http://localhost:3001"
    - "http://localhost:3002"
    - "http://localhost:3003"
    - "http://localhost:5173"
    - "http://127.0.0.1:3000"
    - "http://127.0.0.1:5173"
    # 动态配置：支持自定义前端地址
    - "${FRONTEND_URL}"  # 从环境变量获取前端地址
  allow_credentials: true
  allow_methods: ["*"]
  allow_headers: ["*"]
  # 开发模式：允许更宽松的CORS策略
  development_mode: "${CORS_DEVELOPMENT_MODE:false}"  # 默认false，可通过环境变量启用

# 测试模式配置
test_mode: false  # 全局测试模式开关

# 外部API Mock配置（仅在测试模式下生效）
external_api_mock:
  # 第三方用户认证API
  third_party_auth:
    enabled: true  # 是否mock第三方认证API
    mock_delay: 0.1  # 模拟API调用延迟（秒）
  
  # AI模型API
  ai_models:
    enabled: true  # 是否mock AI模型API
    mock_delay: 0.5  # 模拟AI调用延迟（秒）
    
  # 其他外部服务
  external_services:
    enabled: true  # 是否mock其他外部服务
    mock_delay: 0.2  # 模拟调用延迟（秒）

# 第三方登录配置
third_party_auth:
  # OAuth2配置
  client_id: "${THIRD_PARTY_CLIENT_ID}"  # 从环境变量获取
  client_secret: "${THIRD_PARTY_CLIENT_SECRET}"  # 从环境变量获取
  
  # 动态重定向URL配置 - 支持前端域名/IP端口配置
  frontend_domain: "${FRONTEND_DOMAIN}"  # 前端域名，如: http://localhost:5173 或 https://your-domain.com
  redirect_path: "/callback"  # 回调路径，固定为/callback
  
  scope: "base.profile"
  
  # API端点配置
  api_endpoints:
    authorization_url: "${THIRD_PARTY_AUTH_URL}"  # 授权页面URL
    token_url: "${THIRD_PARTY_TOKEN_URL}"  # 获取token的API
    userinfo_url: "${THIRD_PARTY_USERINFO_URL}"  # 获取用户信息的API
  
  # 超时和重试配置
  request_timeout: 30  # 请求超时时间（秒）
  max_retries: 3  # 最大重试次数
  
  # 示例值（用于文档说明）
  # 实际配置应该通过环境变量设置：
  # THIRD_PARTY_CLIENT_ID=your_client_id
  # THIRD_PARTY_CLIENT_SECRET=your_client_secret  
  # FRONTEND_DOMAIN=http://localhost:5173  # 开发环境
  # FRONTEND_DOMAIN=https://your-production-domain.com  # 生产环境
  # THIRD_PARTY_AUTH_URL=https://auth-provider.com/oauth2/authorize
  # THIRD_PARTY_TOKEN_URL=https://auth-provider.com/oauth2/accesstoken
  # THIRD_PARTY_USERINFO_URL=https://auth-provider.com/oauth2/userinfo

# JWT配置
jwt:
  secret_key: "${JWT_SECRET_KEY}"  # 从环境变量获取
  algorithm: "HS256"
  access_token_expire_minutes: 30
  
# 环境变量映射（可选）
env_mapping:
  OPENAI_API_KEY: "OPENAI_API_KEY"
  ANTHROPIC_API_KEY: "ANTHROPIC_AUTH_TOKEN"
  ANTHROPIC_BASE_URL: "ANTHROPIC_BASE_URL"
  JWT_SECRET_KEY: "JWT_SECRET_KEY"
  THIRD_PARTY_CLIENT_ID: "THIRD_PARTY_CLIENT_ID"
  THIRD_PARTY_CLIENT_SECRET: "THIRD_PARTY_CLIENT_SECRET"
  THIRD_PARTY_REDIRECT_URL: "THIRD_PARTY_REDIRECT_URL"
  THIRD_PARTY_AUTH_URL: "THIRD_PARTY_AUTH_URL"
  THIRD_PARTY_TOKEN_URL: "THIRD_PARTY_TOKEN_URL"
  THIRD_PARTY_USERINFO_URL: "THIRD_PARTY_USERINFO_URL"